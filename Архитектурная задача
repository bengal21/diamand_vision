Сервисы и подходы
1. Уровень доставки email
Основные провайдеры:
Amazon SES (основной канал) - 5-10% от объема
SendGrid/Pepipost (резервный канал) - 5-10% от объема
Собственные SMTP-сервера (80-90% от объема)
Собственная инфраструктура SMTP:
6-8 виртуальных серверов (VPS) в разных дата-центрах
Postfix/Dovecot на Ubuntu/Debian
По 200-250 email-адресов на сервер
Разные IP-адреса для каждого сервера 

2. Оркестрация и управление
Central Management Server:
Node.js/Python микросервис
База данных PostgreSQL для хранения метаданных
Redis для кэширования и очередей
Docker-контейнеризация

3. Балансировка нагрузки
Nginx/Traefik как reverse proxy
Round-robin DNS для распределения запросов
Ротация отправителей:
# Алгоритм ротации:
1. Каждое направление → отдельный пул отправителей (20-30 адресов)
2. Ротация по правилам:
   - Не более 50 писем в день с одного адреса
   - Не более 10 писем в час с одного адреса
   - Автоматическая пауза при высоком bounce rate (>2%)
3. Приоритетность каналов:
   Собственные SMTP → SES → SendGrid
Мониторинг:
В реальном времени:
Статусы доставки (Prometheus + Grafana)
Bounce rate по каждому отправителю
Жалобы на спам (Feedback Loop)
Blacklist мониторинг (mxtoolbox API)
Ежедневные проверки:
Тестовые отправки на проверочные ящики
Проверка репутации IP/доменов
Анализ статистики открытий/кликов
Распределение по клиентам/направлениям:
Каждый клиент → отдельный набор доменов
Каждое направление → отдельный набор отправителей
Изоляция трафика между клиентами

Риски и способы их закрытия
1. Риск: попадание в черные списки
Регулярная ротация IP-адресов
Разделение "теплых" и "холодных" адресов
Постепенное наращивание объемов для новых IP
Мониторинг blacklist в реальном времени.

2. Риск: блокировка провайдерами
Мульти-провайдерская архитектура
Фолбэк на разные каналы при проблемах
Разные домены для разных направлений.

3. Риск: единая точка отказа
Распределение по разным дата-центрам
Автоматическое переключение при сбоях
Репликация базы данных.

Оценка стоимости (месячная)
1. Собственные серверы (основная нагрузка):
8 × VPS (4GB RAM, 2 vCPU): 800 руб. × 8 = 6400 руб./мес
Дополнительные IP-адреса: 300 руб. × 16 = 4800 руб./мес
2. Домены 
20 доменов = 6000 руб./год
Данная архитектура обеспечивает отказоустойчивость за счет распределенности, 
минимизирует стоимость использованием собственных серверов для основной нагрузки, 
и поддерживает качество доставки через активный мониторинг и ротацию.
